% MFCC implement with Matlab %  
Fs = 8000;
% ONE Features
ONE_d1 = [1.754236,8.256807,5.985868,5.121980,4.359594,3.236892,2.681463,1.398229,0.576566,0.175530];
ONE_d2 =  [1.286158,7.539842,6.252186,6.339471,4.265392,3.430290,2.641212,1.855922,0.447115,-0.477752];
ONE_d3 = [1.385982,7.572963,5.946332,6.397130,5.090773,3.844531,0.726698,1.347606,0.472415,-0.539558];
ONE_d4 = [1.395789,7.962110,6.148974,5.809465,4.955983,3.172414,1.805278,1.324979,-0.338337,-0.256652];
ONE_d5 =  [1.664317,8.707352,6.497171,6.830315,3.800416,2.709113,1.310539,1.082821,0.132299,-1.453662];
%ONE_d6 =  [1.298475,8.911732,6.097799,6.260994,4.207582,2.796949,1.689133,0.822314,-0.318129,-1.073914];
%ONE_d7 = [1.668944,8.415964,5.733557,5.424660,4.639001,4.049936,1.920902,0.316454,-0.851195,-1.034472];
%ONE_d8 = [0.726457,8.326927,6.081915,6.264850,4.825276,3.276821,2.731875,2.004726,0.368746,-0.613771];
%ONE_d9 =  [2.225804,9.006822,6.049703,5.484810,3.129053,3.072711,1.465881,0.650107,-0.320300,0.091088];
%ONE_d10 =[0.686037,8.776240,6.366590,5.706832,5.306859,3.006494,1.658489,1.591281,0.334990,-0.408159]; 

%TWO Features
TWO_d1  =[-0.174631,6.860019,6.026347,5.384973,4.439262,4.450933,3.552743,4.066904,2.919245,1.921669];
TWO_d2  =[-0.339572,7.269045,5.255629,5.228974,4.311761,4.323913,4.055178,3.087054,2.185629,2.304016];
TWO_d3  =[-0.573254,6.876798,5.557671,5.707200,4.836710,4.693573,3.703596,2.968913,2.339754,2.114897];
TWO_d4  =[-0.941581,7.227598,5.761351,5.308926,4.440164,4.151866,3.490937,3.863283,2.824457,1.559151];
TWO_d5  =[-1.026067,6.506646,5.520854,8.004482,5.561629,4.844787,4.173260,2.097211,1.832705,2.597324];
%TWO_d6  =[-0.403840,7.128743,5.592531,4.419789,3.907732,4.288236,3.649658,3.750251,3.087708,3.046222];
%TWO_d7  =[0.336321,6.280960,4.230550,5.313420,4.337434,4.461694,3.331524,3.803391,3.380426,2.422145];
%TWO_d8  =[0.656725,6.884895,4.934400,4.743373,4.129587,4.115225,3.605171,2.787783,2.428057,2.017403];
%TWO_d9  =[-0.196405,7.410773,6.003703,4.445064,4.245107,4.345694,4.366747,2.797682,2.681741,2.306602];
%TWO_d10  =[0.588414,7.367954,4.974022,4.933611,2.893646,3.971855,3.410427,4.039519,3.188623,2.696570];

%Three Features
THREE_d1 =  [-0.070760,6.958711,4.964100,5.645166,4.003522,4.037451,3.731322,3.284458,2.888371,2.343054];
THREE_d2 =  [0.953818,7.532062,4.469831,3.793380,3.014230,3.460530,3.088746,3.774896,3.289177,2.670909];
THREE_d3  = [0.781635,7.307945,5.329140,4.517178,3.935483,2.738872,3.065987,3.157820,2.521418,2.402916];
THREE_d4  = [1.641261,7.651683,5.413060,4.159178,2.660275,2.067081,2.942153,2.725663,2.787219,3.105033];
THREE_d5  = [2.140350,7.216726,4.414968,3.848012,2.649488,2.983161,2.514351,2.952157,2.887669,2.617588];
%THREE_d6  = [1.622511,9.218090,5.485973,4.687885,3.475805,2.747098,2.369292,2.681236,2.504188,2.401259];
%THREE_d7  = [2.033801,6.561356,4.510998,4.427094,2.825917,2.928003,2.751393,2.688151,2.192405,2.427585];
%THREE_d8 = [1.200501,7.752304,4.924521,4.566070,3.789591,4.113313,3.429827,2.804256,3.010516,1.932685];
%THREE_d9 = [1.201953,7.228394,4.895003,4.340161,2.293387,3.011493,3.485808,3.521596,3.253832,2.816044];
%THREE_d10 = [1.221457,7.865760,5.110405,4.116972,3.249550,2.403398,2.708317,3.432908,3.093891,2.284258];

%Four Features
FOUR_d1 = [0.735574,7.051990,6.111274,6.407473,4.509209,4.651483,3.214515,2.609751,1.119045,0.276144];
FOUR_d2 =[0.177271,7.356922,5.959943,6.026327,4.861230,4.670940,3.357763,2.722891,0.942313,0.741525];
FOUR_d3 =  [-0.667649,8.491521,6.555258,6.149200,4.957548,4.412689,3.499473,2.031138,0.750780,0.396144];
FOUR_d4 =   [0.161459,8.023388,6.561107,5.625500,4.351299,4.485404,2.865889,2.016032,1.132674,0.680938];
FOUR_d5 = [-0.121325,7.519500,5.930347,6.474289,5.167684,5.186182,3.321546,2.738291,1.196417,0.313573];
%FOUR_d6 =  [0.616767,7.768691,5.930895,6.052698,4.454870,4.229183,3.285080,2.166233,0.748482,0.162372];
%FOUR_d7 = [0.183440,7.880932,6.586167,6.084867,4.907346,4.036794,2.830535,1.528954,0.973202,0.216258];
%FOUR_d8 =  [0.225703,7.007806,6.243983,6.038627,4.813592,4.898752,2.817977,2.957083,0.953506,0.643691];
%FOUR_d9 = [0.336230,7.777575,6.434182,6.151789,4.915307,4.106044,3.339547,2.110022,1.000256,0.506254];
%FOUR_d10 = [-0.333034,8.216641,5.997073,6.089193,5.835215,4.571679,2.467993,2.038051,1.253072,0.863387];

P=[ONE_d1;ONE_d2;ONE_d3;ONE_d4;ONE_d5;...
   TWO_d1;TWO_d2;TWO_d3;TWO_d4;TWO_d5;...
   THREE_d1;THREE_d2;THREE_d3;THREE_d4;THREE_d5;...
   FOUR_d1;FOUR_d2;FOUR_d3;FOUR_d4;FOUR_d5]';
P = round(P,1);
% Training outputs:

T=[0.1 0.1;0.1 0.1;0.1 0.1;0.1 0.1;0.1 0.1;...
   0.1 0.9;0.1 0.9;0.1 0.9;0.1 0.9;0.1 0.9;...
   0.9 0.1;0.9 0.1;0.9 0.1;0.9 0.1;0.9 0.1;...
   0.9 0.9;0.9 0.9;0.9 0.9;0.9 0.9;0.9 0.9;]';

% Teach network with two layers:
[w1, b1, w2, b2, te ,tr]=...
 trainbp(randn(40,10),randn(40,1),'logsig',...
 randn(2,40),randn(2,1),'logsig',P,T,[1 50000 0.0001, 0.4]);

disp('test network')
disp('Network output=>');
layer1out=logsig(w1*P,b1);
network_out=logsig(w2*layer1out,b2)

disp('weights for layer 1:');
w1
b1
disp('weights for layer 2:');
w2
b2

kdemo = 1;
while (kdemo>=1)&&(kdemo<=3),
  clc;
  kdemo = menu('Choose a Demo',...
           'Input test patten',...
           'Run the tranined neural network',...
           'Output the neural network weights',...
           'Quit');

if kdemo==1,
  PP = input('Test pattern (dn):')
  PP=PP';
  figure 
  axis([1 10 1 10]);
  grid
  hold on
  for i=1:1:3
   if PP(i) == -1
    plot(i,3,'*');
   end
  end
  for i=4:1:6
   if PP(i) == -1
    plot(i-3,2,'*');
   end
  end
  for i=7:1:9
   if PP(i) == -1
    plot(i-6,1,'*');
   end
  end
  pause
end

if kdemo==2, % Demonstration 1.
   clc
   PP = input('Test pattern (dn):')
   PP=PP';
   disp('result');
   aa=logsig(w1*PP,b1);
   network_out=logsig(w2*aa,b2);
   pause
end

if kdemo==3, % Demonstration 1.
   clc
   disp('neural network weights');
   w1
   b1
   w2
   b2
   
   pause
end
end
close all
clear all